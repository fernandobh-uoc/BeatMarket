import{f as B}from"./chunk-FIPIWZQS.js";var x,L,P,f,E,w,$,W,j,N,h,M,D,K,R,H,U,Y,A,G,I,q,z,F,J,Q,V,X,S,Z,T,ee,O,b,te,re,oe,ne,se,ce,ae,k,le,pe,ie,y,ue,C,ve,de=B(()=>{x=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");L=e=>{let t=[],r=0;return e=e.replace(/(\[[^\]]*\])/g,(s,a)=>{let c=`__ph-${r}__`;return t.push(a),r++,c}),{content:e.replace(/(:nth-[-\w]+)(\([^)]+\))/g,(s,a,c)=>{let l=`__ph-${r}__`;return t.push(c),r++,a+l}),placeholders:t}},P=(e,t)=>t.replace(/__ph-(\d+)__/g,(r,n)=>e[+n]),f="-shadowcsshost",E="-shadowcssslotted",w="-shadowcsscontext",$=")(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",W=new RegExp("("+f+$,"gim"),j=new RegExp("("+w+$,"gim"),N=new RegExp("("+E+$,"gim"),h=f+"-no-combinator",M=/-shadowcsshost-no-combinator([^\s]*)/,D=[/::shadow/g,/::content/g],K="([>\\s~+[.,{:][\\s\\S]*)?$",R=/-shadowcsshost/gim,H=e=>new RegExp(`((?<!(^@supports(.*)))|(?<={.*))(${e}\\b)`,"gim"),U=H("::slotted"),Y=H(":host"),A=H(":host-context"),G=/\/\*\s*[\s\S]*?\*\//g,I=e=>e.replace(G,""),q=/\/\*\s*#\s*source(Mapping)?URL=[\s\S]+?\*\//g,z=e=>e.match(q)||[],F=/(\s*)([^;\{\}]+?)(\s*)((?:{%BLOCK%}?\s*;?)|(?:\s*;))/g,J=/([{}])/g,Q=/(^.*?[^\\])??((:+)(.*)|$)/,V="{",X="}",S="%BLOCK%",Z=(e,t)=>{let r=T(e),n=0;return r.escapedString.replace(F,(...o)=>{let s=o[2],a="",c=o[4],l="";c&&c.startsWith("{"+S)&&(a=r.blocks[n++],c=c.substring(S.length+1),l="{");let d=t({selector:s,content:a});return`${o[1]}${d.selector}${o[3]}${l}${d.content}${c}`})},T=e=>{let t=e.split(J),r=[],n=[],o=0,s=[];for(let c=0;c<t.length;c++){let l=t[c];l===X&&o--,o>0?s.push(l):(s.length>0&&(n.push(s.join("")),r.push(S),s=[]),r.push(l)),l===V&&o++}return s.length>0&&(n.push(s.join("")),r.push(S)),{escapedString:r.join(""),blocks:n}},ee=e=>(e=e.replace(A,`$1${w}`).replace(Y,`$1${f}`).replace(U,`$1${E}`),e),O=(e,t,r)=>e.replace(t,(...n)=>{if(n[2]){let o=n[2].split(","),s=[];for(let a=0;a<o.length;a++){let c=o[a].trim();if(!c)break;s.push(r(h,c,n[3]))}return s.join(",")}else return h+n[3]}),b=(e,t,r)=>e+t.replace(f,"")+r,te=e=>O(e,W,b),re=(e,t,r)=>t.indexOf(f)>-1?b(e,t,r):e+t+r+", "+t+" "+e+r,oe=(e,t)=>{let r="."+t+" > ",n=[];return e=e.replace(N,(...o)=>{if(o[2]){let s=o[2].trim(),a=o[3],c=r+s+a,l="";for(let g=o[4]-1;g>=0;g--){let p=o[5][g];if(p==="}"||p===",")break;l=p+l}let u=(l+c).trim(),d=`${l.trimEnd()}${c.trim()}`.trim();if(u!==d){let g=`${d}, ${u}`;n.push({orgSelector:u,updatedSelector:g})}return c}else return h+o[3]}),{selectors:n,cssText:e}},ne=e=>O(e,j,re),se=e=>D.reduce((t,r)=>t.replace(r," "),e),ce=e=>{let t=/\[/g,r=/\]/g;return e=e.replace(t,"\\[").replace(r,"\\]"),new RegExp("^("+e+")"+K,"m")},ae=(e,t)=>!ce(t).test(e),k=(e,t)=>e.replace(Q,(r,n="",o,s="",a="")=>n+t+s+a),le=(e,t,r)=>{if(R.lastIndex=0,R.test(e)){let n=`.${r}`;return e.replace(M,(o,s)=>k(s,n)).replace(R,n+" ")}return t+" "+e},pe=(e,t,r)=>{let n=/\[is=([^\]]*)\]/g;t=t.replace(n,(v,...i)=>i[0]);let o="."+t,s=v=>{let i=v.trim();if(!i)return"";if(v.indexOf(h)>-1)i=le(v,t,r);else{let _=v.replace(R,"");_.length>0&&(i=k(_,o))}return i},a=L(e);e=a.content;let c="",l=0,u,d=/( |>|\+|~(?!=))\s*/g,p=!(e.indexOf(h)>-1);for(;(u=d.exec(e))!==null;){let v=u[1],i=e.slice(l,u.index).trim();p=p||i.indexOf(h)>-1;let _=p?s(i):i;c+=`${_} ${v} `,l=d.lastIndex}let m=e.substring(l);return p=p||m.indexOf(h)>-1,c+=p?s(m):m,P(a.placeholders,c)},ie=(e,t,r,n)=>e.split(",").map(o=>n&&o.indexOf("."+n)>-1?o.trim():ae(o,t)?pe(o,t,r).trim():o.trim()).join(", "),y=(e,t,r,n)=>Z(e,o=>{let s=o.selector,a=o.content;return o.selector[0]!=="@"?s=ie(o.selector,t,r,n):(o.selector.startsWith("@media")||o.selector.startsWith("@supports")||o.selector.startsWith("@page")||o.selector.startsWith("@document"))&&(a=y(o.content,t,r,n)),{selector:s.replace(/\s{2,}/g," ").trim(),content:a}}),ue=(e,t,r,n)=>{e=ee(e),e=te(e),e=ne(e);let o=oe(e,n);return e=o.cssText,e=se(e),t&&(e=y(e,t,r,n)),e=C(e,r),e=e.replace(/>\s*\*\s+([^{, ]+)/gm," $1 "),{cssText:e.trim(),slottedSelectors:o.selectors.map(s=>({orgSelector:C(s.orgSelector,r),updatedSelector:C(s.updatedSelector,r)}))}},C=(e,t)=>e.replace(/-shadowcsshost-no-combinator/g,`.${t}`),ve=(e,t)=>{let r=t+"-h",n=t+"-s",o=z(e);e=I(e);let s=ue(e,t,r,n);return e=[s.cssText,...o].join(`
`),s.slottedSelectors.forEach(a=>{let c=new RegExp(x(a.orgSelector),"g");e=e.replace(c,a.updatedSelector)}),e}});de();export{ve as scopeCss};
