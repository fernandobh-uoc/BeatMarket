import{B as nt,I as it,O as Ct,a as Y,b as _t,c as Z,d as tt,e as et,k as ot}from"./chunk-FBV753BW.js";import{a as rt,b as bt,d as gt}from"./chunk-6NUGH5FF.js";import{b as W,c as pt,t as X,u as dt}from"./chunk-VQCHUAXV.js";import{Ca as ht,O as Q,Q as j,R as q,S as U,T as $,ga as H,ha as L,qa as G,ra as J,t as E,v as mt,w as F,wa as K,za as N}from"./chunk-BQ2OOKCX.js";import{$ as s,Ca as g,D as b,Da as f,Ea as a,Kb as D,L as m,M as h,Pb as ut,Qa as I,Ra as S,V as B,W as l,Y as w,_ as P,fa as M,hb as T,ka as d,l as x,nb as k,pa as O,qa as y,ra as R,sa as p,v as st,vb as z,wa as c,xa as u,xb as ct,ya as _,z as A}from"./chunk-DHHGUDQP.js";import{f as V,o as v}from"./chunk-FIPIWZQS.js";var at,lt=V(()=>{"use strict";k();st();pt();dt();bt();k();at=(()=>{let r=class r{constructor(){this.cartRepository=b(rt),this.authService=b(X),this.errorMessage=w(""),this.cartResource=W({request:()=>this.authService.currentUser(),loader:({request:e})=>{var t;if(!this.cartRepository.getCartByUserId$)return x(null);if(!(e!=null&&e._id))return x(null);try{let n=this.cartRepository.getCartByUserId$(e._id);return n!=null?n:x(null)}catch(n){return this.errorMessage.set((t=n==null?void 0:n.message)!=null?t:"Unknown error"),x(null)}}}),this.cartItemsAmount=T(()=>{var e,t;return(t=(e=this.cartResource.value())==null?void 0:e.items.length)!=null?t:0}),this.cartState=T(()=>{var e,t;return{cartItems:(t=(e=this.cartResource.value())==null?void 0:e.items)!=null?t:[],cartItemsAmount:this.cartItemsAmount(),loading:this.cartResource.isLoading(),errorMessage:this.errorMessage()}})}createCart(e){return v(this,null,function*(){yield this.cartRepository.saveCart({userId:e})})}addItemToCart(e){return v(this,null,function*(){let t=this.cartResource.value();if(console.log({cart:t}),!t)return;if(t.items.find(C=>C.postId===e.postId)){console.warn(`Item with postId ${e.postId} already in cart`);return}t.items.push(e),yield this.cartRepository.updateCart(t)})}removeItemFromCart(e){return v(this,null,function*(){let t=this.cartResource.value();if(!t)return;let n=t.items.findIndex(C=>C.postId===e);n!==-1&&(t.items.splice(n,1),yield this.cartRepository.updateCart(t))})}clearCart(){return v(this,null,function*(){let e=this.cartResource.value();e&&(e.items=[],yield this.cartRepository.updateCart(e))})}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})()});function vt(o,r){if(o&1){let i=g();c(0,"ion-searchbar",7),f("ionInput",function(t){let n;m(i);let C=a();return h(C.searchQuery.set((n=t.target.value)!==null&&n!==void 0?n:""))})("keyup.enter",function(){m(i);let t=a();return h(t.submitSearch())})("ionCancel",function(){m(i);let t=a();return h(t.closeSearchBar())}),u()}if(o&2){let i=a();y("value",i.searchDefaultValue())}}function xt(o,r){o&1&&_(0,"ion-back-button",9)}function wt(o,r){if(o&1){let i=g();c(0,"ion-button",10),f("click",function(){m(i);let t=a(3);return h(t.backPressed.emit())}),_(1,"ion-icon",11),u()}}function yt(o,r){if(o&1&&d(0,xt,1,0,"ion-back-button",9)(1,wt,2,0,"ion-button",4),o&2){let i=a(2);p(i.backActionType()==="default"?0:i.backActionType()==="emit"?1:-1)}}function Tt(o,r){o&1&&(c(0,"ion-menu-toggle")(1,"ion-button",4),_(2,"ion-icon",12),u()())}function kt(o,r){if(o&1&&(c(0,"ion-avatar",8),_(1,"img",13),u()),o&2){let i=a(2);s(),y("src",i.avatarUrl(),P)}}function It(o,r){if(o&1&&d(0,yt,2,1)(1,Tt,3,0,"ion-menu-toggle")(2,kt,2,1,"ion-avatar",8),o&2){let i=a();p(i.type()==="arrow-back"?0:i.type()==="menu"?1:-1),s(2),p(i.showAvatar()?2:-1)}}function St(o,r){if(o&1){let i=g();c(0,"ion-button",10),f("click",function(){m(i);let t=a();return h(t.openSearchBar())}),_(1,"ion-icon",14),u()}}function Vt(o,r){if(o&1&&(c(0,"ion-badge",17),I(1),u()),o&2){let i=a(2);s(),S(i.cartItemsAmount())}}function At(o,r){if(o&1){let i=g();c(0,"ion-button",10),f("click",function(){m(i);let t=a();return h(t.goToCart())}),c(1,"div",15),_(2,"ion-icon",16),d(3,Vt,2,1,"ion-badge",17),u()()}if(o&2){let i=a();s(3),p(i.cartItemsAmount()>0?3:-1)}}function Bt(o,r){if(o&1&&_(0,"ion-progress-bar",5),o&2){let i=a();y("value",i.progressBarValue())}}function Pt(o,r){if(o&1){let i=g();c(0,"ion-toolbar",6)(1,"ion-searchbar",18),f("ionInput",function(t){let n;m(i);let C=a();return h(C.searchQuery.set((n=t.target.value)!==null&&n!==void 0?n:""))})("keyup.enter",function(){m(i);let t=a();return h(t.submitSearch())})("ionCancel",function(){m(i);let t=a();return h(t.closeSearchBar())}),u()()}if(o&2){let i=a();s(),y("value",i.searchDefaultValue())}}var Xt,Mt=V(()=>{"use strict";k();ct();mt();ht();_t();Ct();ut();lt();gt();k();Xt=(()=>{let r=class r{constructor(){this.cartService=b(at),this.router=b(D),this.platform=b(F),this.type=l("arrow-back"),this.backActionType=l("default"),this.backPressed=B(),this.largeTitle=l(!1),this.title=l(""),this.titleFontSize=l("large"),this.showSearch=l(!0),this.searchDefaultActive=l(!1),this.searchDefaultValue=l(""),this.searchQuery=w(""),this.searchActive=w(this.searchDefaultActive()),this.showCart=l(!0),this.cartItemsAmount=T(()=>{var e,t;return(t=(e=this.cartService.cartState())==null?void 0:e.cartItemsAmount)!=null?t:0}),this.showProgressBar=l(!1),this.progressBarValue=l(0),this.showAvatar=l(!1),this.avatarUrl=l(""),Y({menu:nt,arrowBack:Z,arrowBackOutline:tt,arrowBackSharp:et,searchOutline:it,cartOutline:ot}),this.mode=this.platform.is("ios")?"ios":"md"}ngOnInit(){this.searchActive.set(this.searchDefaultActive())}openSearchBar(){this.searchActive.set(!0)}closeSearchBar(){this.searchActive.set(!1)}goToCart(){this.router.navigate(["/cart"])}submitSearch(){var e,t;(e=this.searchQuery())!=null&&e.trim()&&this.router.navigate(["/tabs/search"],{queryParams:{query:(t=this.searchQuery())==null?void 0:t.trim()}})}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=M({type:r,selectors:[["app-toolbar"]],inputs:{type:[1,"type"],backActionType:[1,"backActionType"],largeTitle:[1,"largeTitle"],title:[1,"title"],titleFontSize:[1,"titleFontSize"],showSearch:[1,"showSearch"],searchDefaultActive:[1,"searchDefaultActive"],searchDefaultValue:[1,"searchDefaultValue"],showCart:[1,"showCart"],showProgressBar:[1,"showProgressBar"],progressBarValue:[1,"progressBarValue"],showAvatar:[1,"showAvatar"],avatarUrl:[1,"avatarUrl"]},outputs:{backPressed:"backPressed"},decls:11,vars:13,consts:[["color","dark"],["slot","start"],["showCancelButton","always","placeholder","Buscar...",1,"searchbar","md-searchbar",3,"value"],["slot","end"],[1,"toolbar-button"],["color","light",3,"value"],[1,"ios-search-toolbar"],["showCancelButton","always","placeholder","Buscar...",1,"searchbar","md-searchbar",3,"ionInput","keyup.enter","ionCancel","value"],[1,"user-avatar"],["defaultHref","/auth/welcome","icon","arrow-back-outline","color","light","text",""],[1,"toolbar-button",3,"click"],["slot","icon-only","name","arrow-back","color","light"],["slot","icon-only","name","menu","color","light"],["alt","Avatar del usuario",3,"src"],["slot","icon-only","name","search-outline","color","light"],[1,"cart-icon-wrapper"],["slot","icon-only","name","cart-outline","color","light"],["color","dark",1,"cart-badge"],["showCancelButton","always","cancelButtonText","Cancelar","color","light","placeholder","Buscar...",1,"searchbar","ios-searchbar",3,"ionInput","keyup.enter","ionCancel","value"]],template:function(t,n){t&1&&(c(0,"ion-toolbar",0)(1,"ion-buttons",1),d(2,vt,1,1,"ion-searchbar",2)(3,It,3,2),u(),c(4,"ion-buttons",3),d(5,St,2,0,"ion-button",4)(6,At,4,1,"ion-button",4),u(),c(7,"ion-title"),I(8),u(),d(9,Bt,1,1,"ion-progress-bar",5),u(),d(10,Pt,2,1,"ion-toolbar",6)),t&2&&(s(2),p(n.mode==="md"&&n.searchActive()?2:3),s(3),p(n.showSearch()&&!n.searchActive()?5:-1),s(),p(n.showCart()?6:-1),s(),R("large",n.titleFontSize()==="large")("medium",n.titleFontSize()==="medium")("small",n.titleFontSize()==="small"),O("size",n.largeTitle()?"large":void 0),s(),S(n.title()),s(),p(n.showProgressBar()?9:-1),s(),p(n.mode==="ios"&&n.searchActive()?10:-1))},dependencies:[j,H,q,N,L,Q,U,K,$,G,J,z,E],styles:["ion-button[_ngcontent-%COMP%]{margin:0}.toolbar-button[_ngcontent-%COMP%], ion-back-button[_ngcontent-%COMP%]{width:40px;height:40px}ion-back-button[_ngcontent-%COMP%]::part(icon){width:24px;height:24px}.toolbar-button[_ngcontent-%COMP%]{--background: transparent}.large[_ngcontent-%COMP%]{font-size:var(--title-large-size, 1.375rem);font-style:normal;font-weight:400;line-height:var(title-large-line-height, 1.75rem);letter-spacing:var(--title-large-tracking, 0rem)}.medium[_ngcontent-%COMP%]{font-size:var(--title-medium-size, 1rem);font-style:normal;font-weight:500;line-height:var(title-medium-line-height, 1.5rem);letter-spacing:var(--title-medium-tracking, .00938rem)}.small[_ngcontent-%COMP%]{font-size:var(--title-small-size, .875rem);font-style:normal;font-weight:500;line-height:var(title-small-line-height, 1.25rem);letter-spacing:var(--title-small-tracking, .00625rem)}.searchbar[_ngcontent-%COMP%]{--background: var(--ion-color-light-shade);--color: var(--ion-color-dark);--icon-color: var(--ion-color-dark);--cancel-button-color: var(--ion-color-dark);--clear-button-color: var(--ion-color-dark);--placeholder-color: var(--ion-color-dark-shade);--border-radius: 4px}.searchbar.ios-searchbar[_ngcontent-%COMP%]{padding:0}.cart-icon-wrapper[_ngcontent-%COMP%]{position:relative;display:inline-block}.cart-badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:-8px;font-size:.7rem;padding:2px 6px;border-radius:50%}.user-avatar[_ngcontent-%COMP%]{width:40px;height:40px;margin-right:.25rem}"]});let o=r;return o})()});export{at as a,lt as b,Xt as c,Mt as d};
