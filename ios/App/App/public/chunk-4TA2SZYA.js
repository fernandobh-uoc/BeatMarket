import{a as q,b as Ne}from"./chunk-7HX7VADE.js";import{e as qe,f as ot}from"./chunk-2GV3WWDM.js";import{B as Le,F as Ge,a as Z,b as je,n as ee,p as ze}from"./chunk-QZLDCAKT.js";import"./chunk-7QGFDW3N.js";import"./chunk-CVZVN4BI.js";import"./chunk-6RPMLJXL.js";import"./chunk-ZDSPE5PQ.js";import"./chunk-XV6JN3SG.js";import"./chunk-G3RFF6YC.js";import"./chunk-ZSFULLTW.js";import"./chunk-JBWWZWAU.js";import"./chunk-ITJAHDAK.js";import"./chunk-WVJ73LOB.js";import"./chunk-5WOL6UCU.js";import"./chunk-UCDHUJSY.js";import"./chunk-67JKSNDF.js";import"./chunk-UUSPLNXY.js";import"./chunk-DH7DTWFE.js";import"./chunk-JT567OVO.js";import"./chunk-NY55XGVK.js";import"./chunk-UHVVQU73.js";import{a as oe,b as Ke,c as ae,d as le,e as ce,f as se,g as pe,h as de,o as ct}from"./chunk-ZLVYX7G6.js";import{a as N,b as te,d as at}from"./chunk-CC7RULIL.js";import{a as Qe,b as lt}from"./chunk-67M6C2S2.js";import"./chunk-7JRGKQWZ.js";import"./chunk-WI56WTX3.js";import{Aa as $e,Ca as re,R as Me,S as be,T as Pe,Z as Fe,_ as U,aa as D,ca as we,da as J,ia as Oe,ja as Se,ka as ke,la as Ee,oa as W,pa as Te,qa as Ie,ra as Ve,t as ye,ta as X,v as rt,va as Be,wa as Y,xa as Re,ya as Ae}from"./chunk-IBFAPW3Z.js";import{$ as s,$a as k,Ca as C,D as O,Da as h,Ea as u,Eb as ve,Hb as xe,L as g,Lb as nt,M as _,Ma as z,Na as H,Oa as L,Qa as p,Ra as V,Sa as P,Ta as G,Xa as _e,Y as M,Za as he,_ as ge,_a as S,ea as j,fa as Q,hb as F,ia as K,ka as I,kb as fe,nb as T,o as me,qa as f,sa as E,ta as b,ua as v,v as tt,va as x,vb as Ce,wa as a,xa as c,xb as it,ya as w,z as ue}from"./chunk-S4NGLO4I.js";import"./chunk-OHMQXWFK.js";import"./chunk-IZ5VZLPJ.js";import"./chunk-FTZN4423.js";import"./chunk-R4WQGMAA.js";import"./chunk-5WZLWBAD.js";import"./chunk-UAVZGLFE.js";import"./chunk-3VQMIGUA.js";import"./chunk-GWOLSY5V.js";import"./chunk-QQVLEOUP.js";import"./chunk-HJZG4HTK.js";import"./chunk-XR3M57TO.js";import"./chunk-3FE2HO5M.js";import"./chunk-ZKJSTCFA.js";import{a as R,b as ne,f as A,o as $}from"./chunk-FIPIWZQS.js";var He,Ue=A(()=>{"use strict";T();lt();T();He=(()=>{let o=class o{constructor(){this.postRepository=O(Qe),this.query=M(""),this.generalFilters=M([]),this.localFilters=M([]),this.order=M({field:"createdAt",direction:"asc"}),this.limit=M(100),this.errorMessage=M(""),this.searchState=F(()=>({searchParams:{query:this.query(),generalFilters:this.generalFilters(),localFilters:this.localFilters(),order:this.order(),limit:this.limit()},searchResults:this.searchResults(),loading:this.initialResults.isLoading(),errorMessage:this.errorMessage()})),this.initialResults=fe({request:()=>({query:this.query(),generalFilters:this.generalFilters(),limit:this.limit()}),loader:t=>$(this,[t],function*({request:e}){var d;let{generalFilters:n,limit:l}=e;try{this.errorMessage.set("");let m={filters:this.buildConstraintFilters(n),limit:l};return yield this.fetchInitialResults({constraints:m})}catch(m){return this.errorMessage.set((d=m==null?void 0:m.message)!=null?d:"Unknown error"),[]}})}),this.searchResults=F(()=>{var y;let e=(y=this.initialResults.value())!=null?y:[],t=this.query(),n=this.localFilters(),l=this.order(),d=this.filterResults({results:e,query:t,localFilters:n});return this.sortResults({results:d,order:l})})}updateQuery(e){this.query.set(e)}setGeneralFilters({generalFilters:e}){this.generalFilters.set(e)}setLocalFilters({localFilters:e}){this.localFilters.set(e)}updateOrder(e){this.order.set(e)}updateLimit(e){this.limit.set(e)}fetchInitialResults(t){return $(this,arguments,function*({constraints:e}){var n;try{return(n=yield this.postRepository.queryPosts(e))!=null?n:[]}catch(l){throw l}})}filterResults({results:e,query:t,localFilters:n}){let l=e;return t!=="all"&&(l=e.filter(d=>d.title.toLowerCase().split(/\s+/).includes(t.toLowerCase()))),n.length>0&&(l=l.filter(d=>n.every(m=>{let y=m.value,B=d.article.characteristics[m.field];return Array.isArray(y)?y.includes(B):B===y}))),l}sortResults({results:e,order:t}){return e.sort((n,l)=>{var y,B;let d=(y=n[t.field])!=null?y:0,m=(B=l[t.field])!=null?B:0;return d<m?t.direction==="asc"?-1:1:d>m?t.direction==="asc"?1:-1:0})}buildConstraintFilters(e){if(!Object.keys(e).length)return[];let t=e.map(n=>{let{field:l,value:d}=n;return l==="category"?{field:"article.category",operator:"==",value:d}:l==="priceMin"?{field:"price",operator:">=",value:d}:l==="priceMax"?{field:"price",operator:"<=",value:d}:l==="condition"?{or:d.map(m=>({field:"article.condition",operator:"==",value:m}))}:{field:l,operator:"==",value:d}});return t.length>1?[{and:t}]:t}};o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=ue({token:o,factory:o.\u0275fac,providedIn:"root"});let i=o;return i})()});function dt(i,o){if(i&1&&(a(0,"ion-col")(1,"div",25)(2,"ion-radio",26),p(3),c()()()),i&2){let r=o.$implicit;s(2),f("value",r),s(),P(" ",r," ")}}function mt(i,o){if(i&1&&(a(0,"ion-text",20),p(1),c()),i&2){let r=u();s(),V(r.priceErrorMessage())}}function ut(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",27),h("ionChange",function(t){let n=g(r).$implicit,l=u();return _(l.onCheckboxChangeGeneral(t,{key:"condition",value:n}))}),p(2),c()()}if(i&2){let r,e=o.$implicit,t=u();s(),f("value",e)("checked",(r=t.generalFilters().condition)==null?null:r.includes(e)),s(),P(" ",e," ")}}function gt(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"type",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function _t(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"brand",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function ht(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"instrumentLevel",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function ft(i,o){if(i&1&&(a(0,"div",24)(1,"ion-label"),p(2,"Tipo de instrumento"),c(),a(3,"div",22),v(4,gt,3,2,"div",23,b),c()(),a(6,"div",24)(7,"ion-label"),p(8,"Marca"),c(),a(9,"div",22),v(10,_t,3,2,"div",23,b),c()(),a(12,"div",24)(13,"ion-label"),p(14,"Nivel de instrumento"),c(),a(15,"div",22),v(16,ht,3,2,"div",23,b),c()()),i&2){let r=u();s(4),x(r.instrumentTypes),s(6),x(r.instrumentBrands),s(6),x(r.instrumentLevels)}}function Ct(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"format",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function vt(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"genre",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function xt(i,o){if(i&1){let r=C();a(0,"div",24)(1,"ion-label"),p(2,"Formato de grabaci\xF3n"),c(),a(3,"div",22),v(4,Ct,3,2,"div",23,b),c()(),a(6,"div",24)(7,"ion-label"),p(8,"G\xE9nero musical"),c(),a(9,"div",22),v(10,vt,3,2,"div",23,b),c()(),a(12,"div",29)(13,"ion-label"),p(14,"Artista o banda"),c(),a(15,"ion-input",30,3),h("ionBlur",function(){g(r);let t=L(16),n=u();return _(n.addSpecificFilter({key:"artist",value:t.value}))}),c()()}if(i&2){let r=u();s(4),x(r.recordingFormats),s(6),x(r.recordingGenres)}}function yt(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"type",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function Mt(i,o){if(i&1&&(a(0,"div",24)(1,"ion-label"),p(2,"Tipo de accesorio"),c(),a(3,"div",22),v(4,yt,3,2,"div",23,b),c()()),i&2){let r=u();s(4),x(r.accesoryTypes)}}function bt(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"type",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function Pt(i,o){if(i&1&&(a(0,"div",24)(1,"ion-label"),p(2,"Tipo de art\xEDculo profesional"),c(),a(3,"div",22),v(4,bt,3,2,"div",23,b),c()()),i&2){let r=u();s(4),x(r.professionalTypes)}}function Ft(i,o){if(i&1){let r=C();a(0,"div",23)(1,"ion-checkbox",28),h("ionChange",function(t){let n=g(r).$implicit,l=u(2);return _(l.onCheckboxChangeSpecific(t,{key:"theme",value:n}))}),p(2),c()()}if(i&2){let r=o.$implicit;s(),f("value",r),s(),P(" ",r," ")}}function wt(i,o){if(i&1&&(a(0,"div",24)(1,"ion-label"),p(2,"Tema del libro"),c(),a(3,"div",22),v(4,Ft,3,2,"div",23,b),c()()),i&2){let r=u();s(4),x(r.bookThemes)}}var st,pt,De,Je=A(()=>{"use strict";T();re();je();Ge();at();ct();Ne();T();st=["priceMin"],pt=["priceMax"];De=(()=>{let o=class o{constructor(){this.modalController=O(X),this.currencyPipe=O(q),this.generalFilters=M({}),this.specificFilters=M({}),this.categoriesEnum=N,this.categories=Object.values(N).filter(e=>e!==N.None),this.selectedCategory=M(N.None),this.conditionEnum=te,this.conditions=Object.values(te).filter(e=>e!==te.None),this.instrumentTypes=Object.values(oe).filter(e=>e!==oe.None),this.instrumentBrands=Object.values(Ke).filter(e=>typeof e=="object").map(e=>Object.values(e)).flat(),this.instrumentLevels=Object.values(de).filter(e=>e!==de.None),this.accesoryTypes=Object.values(ae).filter(e=>e!==ae.None),this.recordingFormats=Object.values(le).filter(e=>e!==le.None),this.recordingGenres=Object.values(ce).filter(e=>e!==ce.None),this.bookThemes=Object.values(pe).filter(e=>e!==pe.None),this.professionalTypes=Object.values(se).filter(e=>e!==se.None),this.priceMin=j("priceMin"),this.priceMax=j("priceMax"),this.priceErrorMessage=M(""),Z({closeOutline:ee})}ngOnInit(){}onCategoryChange(e){this.selectedCategory.set(e.detail.value),this.specificFilters.set([])}applyFilters(){return this.priceErrorMessage()?null:this.modalController.dismiss({generalFilters:R({},this.generalFilters()),localFilters:R({},this.specificFilters())},"filters")}cancel(){return this.modalController.dismiss()}addGeneralFilter(e){if(e.key==="priceMin"||e.key==="priceMax")if(e.value)e.value=parseFloat(e.value);else{delete this.generalFilters()[e.key];return}this.generalFilters.set(ne(R({},this.generalFilters()),{[e.key]:e.value}))}addSpecificFilter(e){this.specificFilters.set(ne(R({},this.specificFilters()),{[e.key]:e.value}))}onCheckboxChangeGeneral(e,t){var n,l;e.detail.checked?this.addGeneralFilter({key:t.key,value:[...(n=this.generalFilters()[t.key])!=null?n:[],t.value]}):Array.isArray(this.generalFilters()[t.key])&&this.generalFilters()[t.key].length===1?delete this.generalFilters()[t.key]:this.addGeneralFilter({key:t.key,value:(l=this.generalFilters()[t.key])==null?void 0:l.filter(d=>d!==t.value)})}onCheckboxChangeSpecific(e,t){var n,l;e.detail.checked?this.addSpecificFilter({key:t.key,value:[...(n=this.specificFilters()[t.key])!=null?n:[],t.value]}):Array.isArray(this.specificFilters()[t.key])&&this.specificFilters()[t.key].length===1?delete this.specificFilters()[t.key]:this.addSpecificFilter({key:t.key,value:(l=this.specificFilters()[t.key])==null?void 0:l.filter(d=>d!==t.value)})}checkPriceValid(){var e,t,n,l,d,m;return(e=this.priceMin())!=null&&e.value&&((t=this.priceMax())!=null&&t.value)?parseFloat(((l=(n=this.priceMin())==null?void 0:n.value)==null?void 0:l.toString())||"0")>parseFloat(((m=(d=this.priceMax())==null?void 0:d.value)==null?void 0:m.toString())||"0")?(this.priceErrorMessage.set("El precio m\xEDnimo debe ser menor o igual al precio m\xE1ximo"),!1):(this.priceErrorMessage.set(""),!0):!0}formatPrice(e,t){if(isNaN(t))return;let n=this.currencyPipe.transform(t,!1);if(e==="priceMin"){let l=this.priceMin();l&&(l.value=n)}if(e==="priceMax"){let l=this.priceMax();l&&(l.value=n)}}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=Q({type:o,selectors:[["app-filters-modal"]],viewQuery:function(t,n){t&1&&(z(n.priceMin,st,5),z(n.priceMax,pt,5)),t&2&&H(2)},features:[_e([q])],decls:55,vars:3,consts:[["category",""],["priceMin",""],["priceMax",""],["artist",""],["slot","start"],[1,"close-icon-wrapper",3,"click"],["name","close-outline","color","light","size","small",3,"click"],["slot","end"],[1,"custom",3,"click","strong"],[1,"filter-container","category-container"],["color","light",1,"custom"],[1,"category-subtitle"],[1,"radiobuttons-group-wrapper"],[3,"ionChange"],[1,"price-container"],[1,"price-row-wrapper"],[1,"price-label-input-wrapper"],[1,"price-input-row"],["type","text","inputmode","decimal",1,"custom",3,"ionBlur"],["slot","end",1,"price-currency"],["color","danger",1,"error-text"],[1,"condition-container"],[1,"checkboxes-container"],[1,"checkbox-wrapper"],[1,"label-checkboxes-container"],[1,"radiobutton-wrapper"],["labelPlacement","end","color","light",3,"value"],["labelPlacement","end","color","light",3,"ionChange","value","checked"],["labelPlacement","end","color","light",3,"ionChange","value"],[1,"input-container"],["type","text",1,"custom",3,"ionBlur"]],template:function(t,n){if(t&1){let l=C();a(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",4)(3,"div",5),h("click",function(){return g(l),_(n.cancel())}),a(4,"ion-icon",6),h("click",function(){return g(l),_(n.cancel())}),c()()(),a(5,"ion-title"),p(6,"Filtros"),c(),a(7,"ion-buttons",7)(8,"ion-button",8),h("click",function(){return g(l),_(n.applyFilters())}),p(9,"Aplicar"),c()()()(),a(10,"ion-content")(11,"form")(12,"div",9)(13,"ion-label",10),p(14,"Categor\xEDa"),c(),a(15,"ion-text",11),p(16,"Selecciona una categor\xEDa para acceder a filtros espec\xEDficos"),c(),a(17,"div",12)(18,"ion-radio-group",13,0),h("ionChange",function(m){g(l);let y=L(19);return n.onCategoryChange(m),_(n.addGeneralFilter({key:"category",value:y.value}))}),a(20,"ion-row"),v(21,dt,4,2,"ion-col",null,b),c()()()(),a(23,"div",14)(24,"ion-label"),p(25,"Precio"),c(),a(26,"div",15)(27,"div",16)(28,"ion-text"),p(29,"Desde"),c(),a(30,"div",17)(31,"ion-input",18,1),h("ionBlur",function(){g(l);let m=L(32);return n.checkPriceValid()&&n.addGeneralFilter({key:"priceMin",value:m.value}),_(m.value?n.formatPrice("priceMin",m.value):"")}),c(),a(33,"ion-text",19),p(34,"\u20AC"),c()()(),a(35,"div",16)(36,"ion-text"),p(37,"Hasta"),c(),a(38,"div",17)(39,"ion-input",18,2),h("ionBlur",function(){g(l);let m=L(40);return n.checkPriceValid()&&n.addGeneralFilter({key:"priceMax",value:m.value}),_(m.value?n.formatPrice("priceMax",m.value):"")}),c(),a(41,"ion-text",19),p(42,"\u20AC"),c()()()(),I(43,mt,2,1,"ion-text",20),c(),a(44,"div",21)(45,"ion-label"),p(46,"Estado del art\xEDculo"),c(),a(47,"div",22),v(48,ut,3,3,"div",23,b),c()(),I(50,ft,18,0)(51,xt,17,0)(52,Mt,6,0,"div",24)(53,Pt,6,0,"div",24)(54,wt,6,0,"div",24),c()()}if(t&2){let l;s(8),f("strong",!0),s(13),x(n.categories),s(22),E(n.priceErrorMessage()?43:-1),s(5),x(n.conditions),s(2),E((l=n.selectedCategory())===n.categoriesEnum.Instruments?50:l===n.categoriesEnum.Recordings?51:l===n.categoriesEnum.Accessories?52:l===n.categoriesEnum.Professional?53:l===n.categoriesEnum.Books?54:-1)}},dependencies:[Y,Be,Fe,Se,Ae,Oe,J,W,Re,U,Ie,be,Pe,Ve,D],styles:[".close-icon-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;width:3rem;cursor:pointer}ion-button.custom[_ngcontent-%COMP%]{--border-radius: 8px;display:block;width:100%;text-transform:none;cursor:pointer;--background: var(--ion-color-light);--color: var(--ion-color-dark);--padding-start: 1rem;--padding-end: 1rem;--padding-top: .5rem;--padding-bottom: .5rem}form[_ngcontent-%COMP%]{margin-top:1rem;display:flex;flex-direction:column;gap:2.5rem}form[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{display:flex;margin-bottom:1rem;font-size:var(--label-larger-size, 1rem);font-style:normal;font-weight:var(--label-larger-weight, 600);line-height:var(--label-larger-line-height, 1.5rem);letter-spacing:var(--label-larger-tracking, .03125rem)}form[_ngcontent-%COMP%]   ion-label.custom[_ngcontent-%COMP%]{margin-bottom:0rem}form[_ngcontent-%COMP%]   .category-subtitle[_ngcontent-%COMP%]{margin-bottom:.5rem;color:var(--ion-color-light-shade);font-size:var(--body-medium-size, .875rem);font-style:normal;font-weight:var(--body-medium-weight, 400);line-height:var(--body-medium-line-height, 1.25rem);letter-spacing:var(--body-medium-tracking, .01563rem)}form[_ngcontent-%COMP%]   .checkboxes-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;gap:1rem}form[_ngcontent-%COMP%]   .checkboxes-container[_ngcontent-%COMP%]   .checkbox-wrapper[_ngcontent-%COMP%]{display:flex;width:10rem}form[_ngcontent-%COMP%]   .category-container[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:column;gap:.5rem}form[_ngcontent-%COMP%]   .category-container[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.25rem}form[_ngcontent-%COMP%]   .category-container[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{min-width:10rem;max-width:10rem}form[_ngcontent-%COMP%]   .category-container[_ngcontent-%COMP%]   ion-radio-group[_ngcontent-%COMP%]{display:flex;width:100%}form[_ngcontent-%COMP%]   .category-container[_ngcontent-%COMP%]   .radiobutton-wrapper[_ngcontent-%COMP%]{display:flex;gap:1rem}form[_ngcontent-%COMP%]   .category-container[_ngcontent-%COMP%]   .radiobutton-wrapper[_ngcontent-%COMP%]   ion-radio[_ngcontent-%COMP%]{font-size:var(--body-large-size, 1rem);font-style:normal;font-weight:var(body-large-weight, 400);line-height:var(--body-large-line-height, 1.5rem);letter-spacing:var(--body-large-tracking, .03125rem)}form[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]{display:flex;flex-direction:column}form[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-row-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:2rem}form[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-row-wrapper[_ngcontent-%COMP%]   .price-label-input-wrapper[_ngcontent-%COMP%]{flex:1 0 0;display:flex;flex-direction:column;gap:.2rem}form[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-row-wrapper[_ngcontent-%COMP%]   .price-label-input-wrapper[_ngcontent-%COMP%]   .price-input-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem;align-items:center}form[_ngcontent-%COMP%]   .price-container[_ngcontent-%COMP%]   .price-row-wrapper[_ngcontent-%COMP%]   .price-label-input-wrapper[_ngcontent-%COMP%]   .price-input-row[_ngcontent-%COMP%]   .price-currency[_ngcontent-%COMP%]{color:var(--ion-color-light-shade);font-size:var(--label-larger-size, 1.25rem)}"]});let i=o;return i})()});var We,Xe=A(()=>{"use strict";T();We=(()=>{let o=class o{transform(e,...t){return{title:"T\xEDtulo",category:"Categor\xEDa",price:"Precio",priceMin:"Precio (min)",priceMax:"Precio (max)",condition:"Estado",orderBy:"Ordenar por",type:"Tipo",brand:"Marca",instrumentLevel:"Nivel",format:"Formato",genre:"G\xE9nero",artist:"Artista",theme:"Tema"}[e]||e}};o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=K({name:"translateFilterKey",type:o,pure:!0});let i=o;return i})()});var Ye,Ze=A(()=>{"use strict";T();Ye=(()=>{let o=class o{transform(e,...t){return Array.isArray(e)?e.join(", ").toString():e}};o.\u0275fac=function(t){return new(t||o)},o.\u0275pipe=K({name:"translateFilterValue",type:o,pure:!0});let i=o;return i})()});function Et(i,o){if(i&1){let r=C();a(0,"ion-badge",24),h("click",function(){g(r);let t=u();return _(t.resetAllFilters())}),w(1,"ion-icon",25),a(2,"ion-text"),p(3,"Todos los filtros"),c()()}}function Tt(i,o){if(i&1){let r=C();a(0,"ion-badge",26),h("click",function(){g(r);let t=u();return _(t.removeOrder())}),w(1,"ion-icon",25),a(2,"ion-text"),p(3),S(4,"translateFilterKey"),c()()}if(i&2){let r=u();s(3),G("",k(4,2,r.order().field),": ",r.order().direction==="asc"?"Ascendente":"Descendente","")}}function It(i,o){if(i&1&&(a(0,"ion-text"),p(1),S(2,"translateFilterKey"),S(3,"formatCurrency"),c()),i&2){let r=u().$implicit;s(),G("",k(2,2,r.field),": ",k(3,4,r.value),"")}}function Vt(i,o){if(i&1&&(a(0,"ion-text"),p(1),S(2,"translateFilterKey"),S(3,"translateFilterValue"),c()),i&2){let r=u().$implicit;s(),G("",k(2,2,r.field),": ",k(3,4,r.value),"")}}function Bt(i,o){if(i&1){let r=C();a(0,"ion-badge",26),h("click",function(){let t=g(r).$implicit,n=u();return _(n.removeGeneralFilter(t))}),w(1,"ion-icon",25),I(2,It,4,6,"ion-text")(3,Vt,4,6,"ion-text"),c()}if(i&2){let r=o.$implicit;s(2),E(r.field==="priceMin"||r.field==="priceMax"?2:3)}}function Rt(i,o){if(i&1){let r=C();a(0,"ion-badge",26),h("click",function(){let t=g(r).$implicit,n=u();return _(n.removeLocalFilter(t))}),w(1,"ion-icon",25),a(2,"ion-text"),p(3),S(4,"translateFilterKey"),S(5,"translateFilterValue"),c()()}if(i&2){let r=o.$implicit;s(3),G("",k(4,2,r.field),": ",k(5,4,r.value),"")}}function At(i,o){i&1&&(a(0,"div",22),w(1,"ion-spinner",27),c())}function $t(i,o){i&1&&(a(0,"div",23)(1,"ion-text",28),p(2,"No hay resultados"),c()())}function jt(i,o){if(i&1&&(a(0,"ion-item",29)(1,"ion-thumbnail",30),w(2,"img",31),c(),a(3,"div",32)(4,"ion-text",33),p(5),c(),a(6,"ion-label",34),p(7),c(),a(8,"ion-text",35),p(9),S(10,"formatCurrency"),c()()()),i&2){let r=o.$implicit;f("routerLink",he(7,St,"/tabs/post-detail/"+r._id)),s(2),f("src",r.mainImageURL,ge),s(3),V(r.title),s(2),V(r.article.category),s(2),V(k(10,5,r.price))}}function zt(i,o){if(i&1&&v(0,jt,11,9,"ion-item",29,kt),i&2){let r=u();x(r.searchResults())}}var Ot,St,et,kt,xi,Lt=A(()=>{T();it();rt();re();ot();nt();Ue();Ne();je();Ge();re();Je();tt();Xe();Ze();T();Ot=["orderSelectInput"],St=i=>[i],et=(i,o)=>o.field,kt=(i,o)=>o._id;xi=(()=>{let o=class o{constructor(){this.route=O(ve),this.searchService=O(He),this.modalController=O(X),this.orderSelectInput=j("orderSelectInput"),this.searchQuery=F(()=>this.searchService.searchState().searchParams.query),this.generalFilters=F(()=>this.searchService.searchState().searchParams.generalFilters),this.localFilters=F(()=>this.searchService.searchState().searchParams.localFilters),this.order=F(()=>this.searchService.searchState().searchParams.order),this.searchResults=F(()=>this.searchService.searchState().searchResults),this.loading=F(()=>this.searchService.searchState().loading),this.errorMessage=F(()=>this.searchService.searchState().errorMessage),this.query$=this.route.queryParams.pipe(me(e=>e.query)),Z({swapVertical:Le,filter:ze,closeOutline:ee})}ngOnInit(){this.query$.subscribe(e=>{e&&this.searchService.updateQuery(e)})}openFiltersModal(){return $(this,null,function*(){let e=yield this.modalController.create({component:De});e.present();let{data:t,role:n}=yield e.onWillDismiss();if(n==="filters"){let{generalFilters:l,localFilters:d}=t;this.searchService.setGeneralFilters({generalFilters:Object.keys(l).map(m=>({field:m,value:l[m]}))}),this.searchService.setLocalFilters({localFilters:Object.keys(d).map(m=>({field:m,value:d[m]}))})}})}removeGeneralFilter(e){var t,n;this.searchService.setGeneralFilters({generalFilters:(n=(t=this.generalFilters())==null?void 0:t.filter(l=>l.field!==e.field))!=null?n:[]})}removeLocalFilter(e){var t,n;this.searchService.setLocalFilters({localFilters:(n=(t=this.localFilters())==null?void 0:t.filter(l=>l.field!==e.field))!=null?n:[]})}resetAllFilters(){this.searchService.setGeneralFilters({generalFilters:[]}),this.searchService.setLocalFilters({localFilters:[]}),this.removeOrder()}removeOrder(){var e;(e=this.orderSelectInput())==null||e.writeValue(null),this.searchService.updateOrder({field:"createdAt",direction:"asc"})}onOrderChange(e){this.searchService.updateOrder(JSON.parse(e.detail.value))}};o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=Q({type:o,selectors:[["app-search"]],viewQuery:function(t,n){t&1&&z(n.orderSelectInput,Ot,5),t&2&&H()},decls:35,vars:7,consts:[["orderSelectInput",""],[3,"translucent"],["title","Buscar","type","menu",3,"searchDefaultActive","searchDefaultValue"],[3,"fullscreen"],[1,"container"],[1,"filters-container"],[1,"filters-row"],[1,"order-container"],["name","swap-vertical","color","light","size","small"],["interface","popover","selectedText","Ordenar",3,"ionChange"],["value",'{ "field": "title", "direction": "asc" }'],["value",'{ "field": "title", "direction": "desc" }'],["value",'{ "field": "price", "direction": "asc" }'],["value",'{ "field": "price", "direction": "desc" }'],[1,"filters-container",3,"click"],["name","filter","color","light","size","small"],[1,"filters-label"],[1,"filters-badges"],["color","danger","slot","start",1,"filter-badge"],["color","warning","slot","start",1,"filter-badge"],[1,"search-title"],[1,"search-results-list"],[1,"spinner-wrapper"],[1,"container-empty"],["color","danger","slot","start",1,"filter-badge",3,"click"],["name","close-outline","color","dark","size","small"],["color","warning","slot","start",1,"filter-badge",3,"click"],["name","circular"],[1,"text-empty"],[1,"post-item",3,"routerLink"],["slot","start",1,"post-image"],["alt","Imagen principal del anuncio",3,"src"],[1,"labels-container"],[1,"post-title"],[1,"post-category"],[1,"post-price"]],template:function(t,n){if(t&1){let l=C();a(0,"ion-header",1),w(1,"app-toolbar",2),c(),a(2,"ion-content",3)(3,"div",4)(4,"div",5)(5,"div",6)(6,"div",7),w(7,"ion-icon",8),a(8,"ion-select",9,0),h("ionChange",function(m){return g(l),_(n.onOrderChange(m))}),a(10,"ion-select-option",10),p(11,"T\xEDtulo (ascendente)"),c(),a(12,"ion-select-option",11),p(13,"T\xEDtulo (descendente)"),c(),a(14,"ion-select-option",12),p(15,"Precio (ascendente)"),c(),a(16,"ion-select-option",13),p(17,"Precio (descendente)"),c()()(),a(18,"div",14),h("click",function(){return g(l),_(n.openFiltersModal())}),w(19,"ion-icon",15),a(20,"ion-text",16),p(21,"Filtrar"),c()()(),a(22,"div",17),I(23,Et,4,0,"ion-badge",18)(24,Tt,5,4,"ion-badge",19),v(25,Bt,4,1,"ion-badge",19,et),v(27,Rt,6,6,"ion-badge",19,et),c()(),a(29,"ion-text",20),p(30,"Resultados de b\xFAsqueda"),c(),a(31,"div",21),I(32,At,2,0,"div",22)(33,$t,3,0,"div",23)(34,zt,2,0),c()()()}t&2&&(f("translucent",!0),s(),f("searchDefaultActive",!0)("searchDefaultValue",n.searchQuery()),s(),f("fullscreen",!0),s(21),E(n.generalFilters().length>0||n.localFilters().length>0||n.order().field!=="createdAt"?23:-1),s(),E(n.order().field!=="createdAt"?24:-1),s(),x(n.generalFilters()),s(2),x(n.localFilters()),s(5),E(n.loading()?32:n.searchResults().length===0?33:34))},dependencies:[Ee,We,Ye,Me,Y,xe,J,Te,we,W,$e,ke,qe,U,D,Ce,ye,q],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem;padding-top:1rem}.container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;align-items:center;gap:2rem}.container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .order-container[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;gap:.5rem;cursor:pointer}.container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .order-container[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{--placeholder-color: var(--ion-color-light);--placeholder-opacity: 1;--highlight-color-focused: none;--highlight-color-invalid: none;--highlight-color-valid: none;--highlight-height: 0px;--ripple-color: none}.container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filters-row[_ngcontent-%COMP%]   .order-container[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]::part(icon){display:none}.container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filters-badges[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:.5rem;flex-wrap:wrap}.container[_ngcontent-%COMP%]   .filters-container[_ngcontent-%COMP%]   .filters-badges[_ngcontent-%COMP%]   .filter-badge[_ngcontent-%COMP%]{padding-right:.5rem;display:flex;flex-direction:row;align-items:center;gap:.2rem;cursor:pointer}.container[_ngcontent-%COMP%]   .search-title[_ngcontent-%COMP%]{font-family:Montserrat;font-size:var(--headline-small-size, 1.5rem);font-style:normal;font-weight:var(--headline-small-weight, 400);line-height:var(--headline-small-line-height, 2rem);letter-spacing:var(--headline-small-tracking, 0rem);margin-bottom:1rem}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .container-empty[_ngcontent-%COMP%]{margin-top:2rem;display:flex;flex-direction:column;align-items:center;justify-content:center}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .container-empty[_ngcontent-%COMP%]   .text-empty[_ngcontent-%COMP%]{color:var(--ion-color-medium-tint);font-size:var(--body-large-size, 1rem);font-style:normal;font-weight:var(--body-large-weight, 400);line-height:var(--body-large-line-height, 1.5rem);letter-spacing:var(--body-large-tracking, .03125rem)}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .post-item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:flex-start;cursor:pointer;--inner-border-width: 0px;border-bottom:1px solid var(--ion-color-medium-shade);padding-bottom:1rem}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .post-item[_ngcontent-%COMP%]   .post-image[_ngcontent-%COMP%]{--border-radius: 8px}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .post-item[_ngcontent-%COMP%]   .labels-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.2rem;flex:1 1 auto}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .post-item[_ngcontent-%COMP%]   .labels-container[_ngcontent-%COMP%]   .post-title[_ngcontent-%COMP%]{font-size:var(--body-large-size, 1rem);font-style:normal;font-weight:var(--body-large-weight, 400);line-height:var(1rem);letter-spacing:var(--body-large-tracking, .03125rem)}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .post-item[_ngcontent-%COMP%]   .labels-container[_ngcontent-%COMP%]   .post-category[_ngcontent-%COMP%]{font-size:var(--label-large-size, .875rem);font-style:normal;font-weight:var(--label-large-weight-prominent, 600);line-height:var(--label-large-line-height, 1.25rem);letter-spacing:var(--label-large-tracking, .00625rem)}.container[_ngcontent-%COMP%]   .search-results-list[_ngcontent-%COMP%]   .post-item[_ngcontent-%COMP%]   .labels-container[_ngcontent-%COMP%]   .post-price[_ngcontent-%COMP%]{font-size:1.25rem;font-style:normal;font-weight:600;line-height:1.625rem}"]});let i=o;return i})()});Lt();export{xi as SearchPage};
