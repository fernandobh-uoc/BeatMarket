import{c as K,d as se}from"./chunk-VVI7QVF5.js";import"./chunk-QCXXS2IP.js";import{a as Q,b as ae}from"./chunk-PIDRDD2T.js";import"./chunk-6NUGH5FF.js";import{b as A,c as oe,t as J,u as re}from"./chunk-VQCHUAXV.js";import"./chunk-K5TY53DO.js";import"./chunk-4XKNA7IF.js";import"./chunk-4FRKXPG4.js";import"./chunk-E4HNE3PW.js";import"./chunk-P2UHFIXP.js";import"./chunk-XV6JN3SG.js";import"./chunk-G3RFF6YC.js";import"./chunk-GTZXGHKK.js";import"./chunk-JBWWZWAU.js";import"./chunk-ITJAHDAK.js";import"./chunk-WVJ73LOB.js";import{Ca as G,Q as $,_ as D,aa as q,ea as H,la as N,oa as M,t as U,v as ie}from"./chunk-BQ2OOKCX.js";import{$ as a,D as C,Da as L,Ea as m,Lb as F,Pb as ne,Qa as g,Ra as x,W as b,Y as y,Za as k,_ as O,_a as I,ab as E,fa as h,hb as u,ka as _,l,nb as f,qa as p,ra as S,sa as v,ua as T,ub as z,v as te,va as w,vb as R,wa as s,xa as c,xb as j,ya as d,z as B}from"./chunk-DHHGUDQP.js";import"./chunk-OHMQXWFK.js";import"./chunk-S6VCIYOJ.js";import"./chunk-25CU3KXX.js";import"./chunk-67JKSNDF.js";import"./chunk-UUSPLNXY.js";import"./chunk-DH7DTWFE.js";import"./chunk-JT567OVO.js";import"./chunk-NY55XGVK.js";import"./chunk-UHVVQU73.js";import"./chunk-IZ5VZLPJ.js";import"./chunk-FTZN4423.js";import"./chunk-R4WQGMAA.js";import"./chunk-5WZLWBAD.js";import"./chunk-UAVZGLFE.js";import"./chunk-3VQMIGUA.js";import"./chunk-GWOLSY5V.js";import"./chunk-QQVLEOUP.js";import"./chunk-HJZG4HTK.js";import"./chunk-XR3M57TO.js";import"./chunk-3FE2HO5M.js";import"./chunk-ZKJSTCFA.js";import{f as P}from"./chunk-FIPIWZQS.js";var W,X=P(()=>{"use strict";f();oe();te();ae();re();f();W=(()=>{let t=class t{constructor(){this.conversationRepository=C(Q),this.authService=C(J),this.errorMessage=y(""),this.conversationsAsSeller=A({request:()=>{var n,i;return(i=(n=this.authService.currentUser())==null?void 0:n._id)!=null?i:null},loader:({request:n})=>{var i;if(!this.conversationRepository.getConversationsBySellerId$)return l(null);if(!n)return l(null);try{let o=this.conversationRepository.getConversationsBySellerId$(n);return o!=null?o:l(null)}catch(o){return this.errorMessage.set((i=o==null?void 0:o.message)!=null?i:"Unknown error"),l(null)}}}),this.conversationsAsBuyer=A({request:()=>{var n,i;return(i=(n=this.authService.currentUser())==null?void 0:n._id)!=null?i:null},loader:({request:n})=>{var i;if(!this.conversationRepository.getConversationsByBuyerId$)return l(null);if(!n)return l(null);try{let o=this.conversationRepository.getConversationsByBuyerId$(n);return o!=null?o:l(null)}catch(o){return this.errorMessage.set((i=o==null?void 0:o.message)!=null?i:"Unknown error"),l(null)}}}),this.conversationsListState=u(()=>{var n,i;return{conversationsAsSeller:(n=this.conversationsAsSeller.value())!=null?n:[],conversationsAsBuyer:(i=this.conversationsAsBuyer.value())!=null?i:[],loading:this.conversationsAsSeller.isLoading()||this.conversationsAsBuyer.isLoading(),errorMessage:this.errorMessage()}})}};t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=B({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})()});function pe(e,t){e&1&&(s(0,"div",0)(1,"ion-text",2),g(2,"No hay conversaciones"),c()())}function me(e,t){if(e&1&&d(0,"img",6),e&2){let r=m().$implicit;p("src",r.participants.seller.profilePictureURL,O)}}function ve(e,t){if(e&1&&d(0,"img",6),e&2){let r=m().$implicit;p("src",r.participants.buyer.profilePictureURL,O)}}function de(e,t){if(e&1&&(s(0,"div",3)(1,"div",4)(2,"ion-avatar",5),_(3,me,1,1,"img",6)(4,ve,1,1,"img",6),c(),s(5,"div",7)(6,"ion-text",8),g(7),c(),s(8,"ion-text",9),g(9),c()()(),s(10,"div",10)(11,"ion-text",10),g(12),I(13,"date"),c()()()),e&2){let r=t.$implicit,n=m(2);p("routerLink",k(9,ce,"/conversation/"+r._id)),a(3),v(n.type()==="asBuyer"?3:-1),a(),v(n.type()==="asSeller"?4:-1),a(3),x(n.type()==="asBuyer"?r.participants.seller.username:r.participants.buyer.username),a(2),x(r.relatedPost.title),a(3),x(E(13,6,r.updatedAt,"dd/MM/yyyy"))}}function ge(e,t){if(e&1&&(s(0,"ion-list",1),T(1,de,14,11,"div",3,le),c()),e&2){let r=m();a(),w(r.conversations())}}var ce,le,Y,Z=P(()=>{"use strict";f();G();j();ne();f();ce=e=>[e],le=(e,t)=>t._id;Y=(()=>{let t=class t{constructor(){this.conversations=b([]),this.type=b("asBuyer")}ngOnInit(){}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=h({type:t,selectors:[["app-conversations-list"]],inputs:{conversations:[1,"conversations"],type:[1,"type"]},decls:2,vars:1,consts:[[1,"container-empty"],["lines","none",1,"conversations-list"],[1,"text-empty"],[1,"conversation-item",3,"routerLink"],[1,"conversation-data"],[1,"user-avatar"],["alt","Avatar del usuario",3,"src"],[1,"labels-container"],[1,"user-name"],[1,"post-title"],[1,"conversation-date"]],template:function(i,o){i&1&&_(0,pe,3,0,"div",0)(1,ge,3,0,"ion-list",1),i&2&&v(o.conversations().length===0?0:1)},dependencies:[F,z,$,H,M],styles:[".container-empty[_ngcontent-%COMP%]{margin-top:4rem;display:flex;flex-direction:column;align-items:center;justify-content:center}.container-empty[_ngcontent-%COMP%]   .text-empty[_ngcontent-%COMP%]{color:var(--ion-color-medium-tint);font-size:var(--body-large-size, 1rem);font-style:normal;font-weight:var(--body-large-weight, 400);line-height:var(--body-large-line-height, 1.5rem);letter-spacing:var(--body-large-tracking, .03125rem)}ion-list.conversations-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2rem}ion-list.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]{--padding-start: 0;display:flex;flex-direction:row;justify-content:space-between;cursor:pointer}ion-list.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-data[_ngcontent-%COMP%]{display:flex;flex-direction:row;gap:1rem;width:60%}ion-list.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-data[_ngcontent-%COMP%]   ion-avatar.user-avatar[_ngcontent-%COMP%]{min-height:48px;min-width:48px}ion-list.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-data[_ngcontent-%COMP%]   .labels-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}ion-list.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-data[_ngcontent-%COMP%]   .labels-container[_ngcontent-%COMP%]   .user-name[_ngcontent-%COMP%]{font-size:var(--label-larger-size, 1.25rem);font-style:normal;font-weight:var(--label-larger-weight, 400);line-height:var(--label-larger-line-height, 1.625rem);letter-spacing:var(--label-larger-tracking, 0)}ion-list.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-data[_ngcontent-%COMP%]   .labels-container[_ngcontent-%COMP%]   .post-title[_ngcontent-%COMP%]{color:var(--ion-color-light-shade);font-size:var(--label-large-size, .875rem);font-style:normal;font-weight:var(--label-large-weight-normal, 400);line-height:var(--label-large-line-height, 1.25rem);letter-spacing:var(--label-large-tracking, .00625rem)}ion-list.conversations-list[_ngcontent-%COMP%]   .conversation-item[_ngcontent-%COMP%]   .conversation-date[_ngcontent-%COMP%]{text-align:right;font-size:var(--label-large-size, .875rem);font-style:normal;font-weight:var(--label-large-weight-prominent, 600);line-height:var(--label-large-line-height, 1.25rem);letter-spacing:var(--label-large-tracking, .00625rem)}"]});let e=t;return e})()});function ue(e,t){e&1&&(s(0,"div",7),d(1,"ion-spinner",8),c())}function _e(e,t){if(e&1&&d(0,"app-conversations-list",9),e&2){let r=m(2);p("conversations",r.conversationsAsBuyer())("type","asBuyer")}}function fe(e,t){if(e&1&&d(0,"app-conversations-list",9),e&2){let r=m(2);p("conversations",r.conversationsAsSeller())("type","asSeller")}}function Ce(e,t){if(e&1&&_(0,_e,1,2,"app-conversations-list",9)(1,fe,1,2,"app-conversations-list",9),e&2){let r=m();v(r.selectedTab()==="conversationsAsBuyer"?0:-1),a(),v(r.selectedTab()==="conversationsAsSeller"?1:-1)}}var De,ye=P(()=>{f();j();ie();G();X();se();Z();f();De=(()=>{let t=class t{constructor(){this.conversationsListService=C(W),this.selectedTab=y("conversationsAsBuyer"),this.conversationsAsBuyer=u(()=>this.conversationsListService.conversationsListState().conversationsAsBuyer.filter(n=>n.messages.length>0)),this.conversationsAsSeller=u(()=>this.conversationsListService.conversationsListState().conversationsAsSeller.filter(n=>n.messages.length>0)),this.conversations=u(()=>({asBuyer:this.conversationsAsBuyer(),asSeller:this.conversationsAsSeller()})),this.loading=u(()=>this.conversationsListService.conversationsListState().loading),this.errorMessage=u(()=>this.conversationsListService.conversationsListState().errorMessage)}};t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=h({type:t,selectors:[["app-conversations-list-page"]],decls:13,vars:7,consts:[[3,"translucent"],["type","menu","title","Mensajes"],[3,"fullscreen"],[1,"container"],[1,"top-tabs-container"],[1,"as-buyer-tab",3,"click"],[1,"as-seller-tab",3,"click"],[1,"loading-spinner-container"],["name","crescent"],[3,"conversations","type"]],template:function(i,o){i&1&&(s(0,"ion-header",0),d(1,"app-toolbar",1),c(),s(2,"ion-content",2)(3,"div",3)(4,"div",4)(5,"div",5),L("click",function(){return o.selectedTab.set("conversationsAsBuyer")}),s(6,"ion-text"),g(7,"Como comprador"),c()(),s(8,"div",6),L("click",function(){return o.selectedTab.set("conversationsAsSeller")}),s(9,"ion-text"),g(10,"Como vendedor"),c()()(),_(11,ue,2,0,"div",7)(12,Ce,2,2),c()()),i&2&&(p("translucent",!0),a(2),p("fullscreen",!0),a(4),S("selected",o.selectedTab()==="conversationsAsBuyer"),a(3),S("selected",o.selectedTab()==="conversationsAsSeller"),a(2),v(o.loading()?11:12))},dependencies:[N,K,Y,M,D,q,R,U],styles:[".container[_ngcontent-%COMP%]{display:flex;flex-direction:column;min-height:100%}.container[_ngcontent-%COMP%]   .loading-spinner-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;align-items:center;padding:1rem 0}.container[_ngcontent-%COMP%]   .top-tabs-container[_ngcontent-%COMP%]{display:flex;flex-direction:row;min-height:4rem;min-width:100dvw;margin-left:-1.5rem;margin-bottom:3rem}.container[_ngcontent-%COMP%]   .top-tabs-container[_ngcontent-%COMP%] > .as-buyer-tab[_ngcontent-%COMP%], .container[_ngcontent-%COMP%]   .top-tabs-container[_ngcontent-%COMP%] > .as-seller-tab[_ngcontent-%COMP%]{text-align:center;flex:1 0 0;display:flex;align-items:center;justify-content:center;color:var(--ion-color-medium);cursor:pointer}.container[_ngcontent-%COMP%]   .top-tabs-container[_ngcontent-%COMP%]   .as-buyer-tab[_ngcontent-%COMP%]{border-right:1px solid var(--ion-color-dark-tint)}.container[_ngcontent-%COMP%]   .top-tabs-container[_ngcontent-%COMP%]   .as-seller-tab[_ngcontent-%COMP%]{border-left:1px solid var(--ion-color-dark-tint)}.container[_ngcontent-%COMP%]   .top-tabs-container[_ngcontent-%COMP%]   .selected[_ngcontent-%COMP%]{color:var(--ion-color-light)}"]});let e=t;return e})()});ye();export{De as ConversationsListPage};
